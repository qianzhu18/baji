<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½œå“ç”»å»Š - å§å”§ç”Ÿæˆå™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="/static/js/device-manager.js"></script>
    <link rel="stylesheet" href="/static/css/design.css">
    <script src="/static/js/user-state-manager.js"></script>
    <script src="/static/js/magic-experience.js"></script>
    <script src="/static/js/navigation.js"></script>
    <style>
        .case-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .case-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);
        }

        .case-image {
            transition: transform 0.5s ease;
        }

        .case-card:hover .case-image {
            transform: scale(1.1);
        }

        .filter-tab {
            transition: all 0.2s ease;
        }

        .filter-tab.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            transform: scale(1.05);
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .nav-link {
            position: relative;
            padding: 0.5rem 0;
            font-weight: 500;
        }

        .nav-link:hover {
            transform: translateY(-1px);
        }

        .mobile-menu {
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* å¯¼èˆªç»„ä»¶æ ·å¼ */
        .user-menu-dropdown {
            transition: all 0.2s ease-out;
            transform-origin: top right;
        }
        
        .menu-open {
            opacity: 1;
            transform: translateY(0) scale(1);
            visibility: visible;
        }
        
        .menu-closed {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            visibility: hidden;
        }
        
        .user-menu-btn {
            transition: all 0.2s ease-out;
        }
        
        .user-menu-btn:hover {
            transform: translateY(-1px);
        }
        
        .user-menu-dropdown a,
        .user-menu-dropdown button {
            transition: all 0.15s ease-out;
        }
        
        .user-menu-dropdown a:hover,
        .user-menu-dropdown button:hover {
            transform: translateX(2px);
            background-color: rgba(59, 130, 246, 0.05);
        }
        
        /* å§å”§ç”»å»Šåœ†å½¢é¢„è§ˆæ ·å¼ */
        .baji-preview-gallery {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            padding: 1rem;
        }
        
        .baji-frame-gallery {
            position: relative;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 20px rgba(59, 130, 246, 0.1),
                0 0 40px rgba(59, 130, 246, 0.05);
            overflow: hidden;
        }
        
        .baji-frame-gallery::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                transparent 0%,
                transparent 70%,
                rgba(0, 0, 0, 0.1) 85%,
                rgba(0, 0, 0, 0.2) 100%
            );
            pointer-events: none;
            z-index: 1;
        }
        
        .case-image {
            width: 180px !important;
            height: 180px !important;
            border-radius: 50%;
            object-fit: cover;
            transition: all 0.3s ease;
            position: relative;
            z-index: 0;
        }
        
        .case-card:hover .case-image {
            transform: scale(1.05);
        }
        
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .baji-frame-gallery {
                width: 280px;
                height: 280px;
            }
            
            .case-image {
                width: 250px !important;
                height: 250px !important;
            }
        }
    </style>
</head>

<body class="bg-gray-50">
    <div id="app">
        <!-- ç»Ÿä¸€å¯¼èˆªæ  -->
        <nav class="navbar bg-white shadow-sm border-b border-gray-200">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between h-16">
                    <!-- Logoå’Œæ ‡é¢˜ -->
                    <div class="flex items-center space-x-4">
                        <a href="/" class="flex items-center space-x-2 text-blue-600 hover:text-blue-700 transition-colors">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                            <span class="text-xl font-bold">å§å”§ç”Ÿæˆå™¨</span>
                        </a>
                    </div>

                    <!-- å¯¼èˆªèœå• -->
                    <div class="hidden md:flex items-center space-x-6">
                        <a href="/" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            é¦–é¡µ
                        </a>
                        <a href="/gallery" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            ä½œå“ç”»å»Š
                        </a>
                        <a href="/design" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            å¼€å§‹è®¾è®¡
                        </a>
                        <a href="/history" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            åˆ¶ä½œå†å²
                        </a>
                        <a href="/orders" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            æˆ‘çš„è®¢å•
                        </a>
                    </div>

                    <!-- ç”¨æˆ·èœå• -->
                    <div class="flex items-center space-x-2">
                        <div class="relative">
                            <button @click="toggleUserMenu" class="user-menu-btn flex items-center space-x-2 p-2 rounded-lg text-gray-600 hover:text-blue-600 hover:bg-gray-100 transition-colors">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                </div>
                                <span class="hidden md:block text-sm font-medium">æˆ‘çš„è´¦æˆ·</span>
                                <svg class="w-4 h-4 transition-transform" :class="{ 'rotate-180': userMenuOpen }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>

                            <!-- ç”¨æˆ·èœå•ä¸‹æ‹‰ -->
                            <div v-show="userMenuOpen" class="user-menu-dropdown absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50" :class="{ 'menu-open': userMenuOpen, 'menu-closed': !userMenuOpen }">
                                <!-- ç”¨æˆ·ä¿¡æ¯ -->
                                <div class="px-4 py-3 border-b border-gray-100">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">è®¿å®¢ç”¨æˆ·</p>
                                            <p class="text-xs text-gray-500">åŸºäºè®¢å•å·çš„èº«ä»½ç®¡ç†</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- å¿«é€Ÿæ“ä½œ -->
                                <div class="px-2 py-2">
                                    <a href="/" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path>
                                        </svg>
                                        é¦–é¡µ
                                    </a>
                                    <a href="/gallery" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                        </svg>
                                        ä½œå“ç”»å»Š
                                    </a>
                                    <a href="/design" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        å¼€å§‹è®¾è®¡
                                    </a>
                                    <a href="/orders" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                                        </svg>
                                        æˆ‘çš„è®¢å•
                                    </a>
                                    <a href="/history" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        è®¾è®¡å†å²
                                    </a>
                                    <a href="/delivery" class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                        </svg>
                                        é…é€ç®¡ç†
                                    </a>
                                </div>
  
                                <!-- åˆ†éš”çº¿ -->
                                <div class="border-t border-gray-100 my-2"></div>

                                <!-- å¸®åŠ©å’Œå…³äº -->
                                <div class="px-2 py-2">
                                    <button @click="showHelp" class="flex items-center w-full px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        å¸®åŠ©ä¸­å¿ƒ
                                    </button>
                                    <!-- <button @click="resetUserData" class="flex items-center w-full px-2 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                        </svg>
                                        é‡ç½®æ•°æ®
                                    </button> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- é¡µé¢å¤´éƒ¨ï¼šå…¨æ¯æ•°æ®åº“é£æ ¼ -->
        [% raw %]
        <div class="gallery-header bg-transparent relative">
            <div class="container mx-auto px-4 py-12 relative z-10">
                
                <div class="text-center mb-12 relative">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-9xl font-black text-white/5 pointer-events-none select-none tracking-widest scale-150">
                        ARCHIVE
                    </div>
                    
                    <div class="relative z-10">
                        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-purple-500/30 bg-purple-500/10 text-purple-300 text-[10px] font-mono mb-4 tracking-[0.2em]">
                            <span class="w-1.5 h-1.5 bg-purple-400 rounded-full animate-pulse"></span>
                            DATABASE_ACCESS
                        </div>
                        
                        <h1 class="text-4xl md:text-6xl font-black text-white mb-4 tracking-tighter drop-shadow-[0_0_15px_rgba(217,70,239,0.3)]">
                            çµæ„Ÿ<span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400">Â·å…¨æ¯åº“</span>
                        </h1>
                        
                        <p class="text-gray-400 font-mono text-sm md:text-base max-w-xl mx-auto">
                            [æ£€ç´¢ç»“æœ] æ¢ç´¢ <span class="text-cyan-400">User_Generated_Content</span> çš„æ— é™å¯èƒ½ã€‚
                        </p>
                    </div>
                </div>

                <div class="gallery-controls max-w-5xl mx-auto">
                    
                    <div class="search-box mb-10 flex justify-center">
                        <div class="relative w-full max-w-xl group">
                            <div class="absolute -inset-0.5 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full opacity-30 group-focus-within:opacity-100 transition duration-500 blur"></div>
                            
                            <div class="relative flex items-center bg-[#0b1224] rounded-full p-1 border border-white/10">
                                <div class="pl-4 pr-2 text-gray-500 font-mono select-none">root@baji:~#</div>
                                <input type="text" 
                                       placeholder="è¾“å…¥å…³é”®è¯æ£€ç´¢æ•°æ®..." 
                                       class="search-input w-full bg-transparent text-cyan-50 px-2 py-3 focus:outline-none font-mono text-sm placeholder-gray-400"
                                       v-model="searchQuery" 
                                       @keyup.enter="searchCases">
                                <button @click="searchCases" class="p-2 rounded-full bg-white/5 hover:bg-cyan-500/20 text-gray-300 hover:text-cyan-200 transition mr-1">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="filter-tabs flex flex-wrap justify-center gap-3">
                        <button v-for="filter in filters" :key="filter.value"
                                @click="setFilter(filter.value)" 
                                class="px-5 py-2 rounded border text-sm font-bold tracking-wide transition-all relative overflow-hidden group"
                                :class="[
                                    currentFilter === filter.value 
                                    ? 'border-cyan-500/50 bg-cyan-500/10 text-cyan-300 shadow-[0_0_15px_rgba(34,211,238,0.2)]' 
                                    : 'border-white/10 bg-white/5 text-gray-400 hover:border-white/30 hover:text-white hover:bg-white/10'
                                ]">
                            <span class="relative z-10" v-text="filter.label"></span>
                            <div v-if="currentFilter === filter.value" class="absolute inset-0 bg-cyan-400/10 transform -skew-x-12 translate-x-full group-hover:translate-x-0 transition-transform"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        [% endraw %]

        <!-- ä½œå“ç½‘æ ¼ -->
        <div class="gallery-content">
            <div class="container mx-auto px-4 py-8">
                <!-- åŠ è½½çŠ¶æ€ -->
                <div v-if="loading" class="text-center py-12">
                    <div
                        class="loading-spinner w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4">
                    </div>
                    <p class="text-gray-600">åŠ è½½ä¸­...</p>
                </div>

                <!-- ä½œå“ç½‘æ ¼ -->
                <div v-else-if="cases.length > 0"
                    class="cases-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <div v-for="caseData in cases" :key="caseData.id"
                        class="holo-card group relative rounded-2xl overflow-hidden transition-all duration-300 hover:-translate-y-2">

                        <!-- æ¡ˆä¾‹å›¾ç‰‡ -->
                        <div class="case-image-container relative overflow-hidden rounded-t-xl"
                            style="aspect-ratio: 1;">
                            <div class="baji-preview-gallery">
                                <div class="baji-frame-gallery">
                                    <img :src="getImageUrl(caseData.preview_image_path)" :alt="caseData.title"
                                        class="case-image w-full h-full object-contain" @click="viewCase(caseData.id)">
                                </div>
                            </div>

                            <!-- æ¡ˆä¾‹æ ‡ç­¾ -->
                            <div class="case-badges absolute top-3 left-3 flex flex-col gap-2">
                                <span v-if="caseData.is_featured"
                                    class="badge badge-featured px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-600">
                                    â­ æ¨è
                                </span>
                                <span v-if="caseData.case_type === 'draft'"
                                    class="badge badge-draft px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-600">
                                    ğŸ“ è‰ç¨¿
                                </span>
                            </div>

                            <!-- æ‚¬åœæ“ä½œ -->
                            <div
                                class="case-overlay absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300">
                                <div class="case-actions flex gap-3">
                                    <button
                                        class="action-btn primary flex items-center space-x-2 px-4 py-2 rounded-full bg-white text-gray-800 hover:bg-blue-50 hover:text-blue-600 transform translate-y-4 group-hover:translate-y-0 transition-all duration-300"
                                        @click="makeSame(caseData.id)">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        <span>åˆ¶ä½œåŒæ¬¾</span>
                                    </button>
                                    <button
                                        class="action-btn secondary flex items-center space-x-2 px-4 py-2 rounded-full bg-white text-gray-800 hover:bg-red-50 hover:text-red-600 transform translate-y-4 group-hover:translate-y-0 transition-all duration-300"
                                        @click="likeCase(caseData.id)">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                                            </path>
                                        </svg>
                                        <span v-text="caseData.like_count"></span>
                                    </button>
                                    <button
                                        class="action-btn secondary flex items-center space-x-2 px-4 py-2 rounded-full bg-white text-gray-800 hover:bg-green-50 hover:text-green-600 transform translate-y-4 group-hover:translate-y-0 transition-all duration-300"
                                        @click="shareCase(caseData.id)">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z">
                                            </path>
                                        </svg>
                                        <span>åˆ†äº«</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- æ¡ˆä¾‹ä¿¡æ¯ -->
                        <div class="case-info p-4">
                            <h3 class="case-title text-lg font-semibold text-gray-800 mb-2" v-text="caseData.title">
                            </h3>
                            <p class="case-description text-sm text-gray-600 mb-3" v-text="caseData     .description">
                            </p>

                            <div class="case-meta">
                                <div class="case-tags flex flex-wrap gap-2 mb-3">
                                    <span v-for="tag in caseData.tags" :key="tag"
                                        class="tag px-2 py-1 rounded-full bg-blue-100 text-blue-600 text-xs">
                                        <span v-text="tag"></span>
                                    </span>
                                </div>

                                <div class="case-stats flex justify-between items-center text-sm text-gray-500">
                                    <span class="stat flex items-center space-x-1">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
                                            </path>
                                        </svg>
                                        <span v-text="  caseData.view_count"></span>
                                    </span>
                                    <span class="stat flex items-center space-x-1">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        <span v-text="caseData.make_count"></span>
                                    </span>
                                    <span class="stat flex items-center space-x-1">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                                            </path>
                                        </svg>
                                        <span v-text="caseData.like_count"></span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div v-else class="text-center py-12">
                    <div class="empty-icon mb-4">
                        <svg class="w-16 h-16 text-gray-400 mx-auto" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                            </path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">æš‚æ— ä½œå“</h3>
                    <p class="text-gray-600 mb-6">è¿˜æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ä½œå“</p>
                    <button
                        class="btn btn-primary px-6 py-3 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors"
                        @click="clearSearch">
                        æ¸…é™¤ç­›é€‰
                    </button>
                </div>

                <!-- åŠ è½½æ›´å¤š -->
                <div v-if="hasMore && !loading" class="load-more-section text-center py-12">
                    <button
                        class="btn btn-primary px-8 py-3 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors"
                        @click="loadMoreCases">
                        åŠ è½½æ›´å¤š
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    cases: [],
                    currentFilter: 'all',
                    searchQuery: '',
                    loading: false,
                    hasMore: true,
                    page: 1,
                    // å¯¼èˆªç»„ä»¶æ•°æ®
                    userMenuOpen: false,
                    filters: [
                        { value: 'all', label: 'å…¨éƒ¨' },
                        { value: 'featured', label: 'æ¨è' },
                        { value: 'popular', label: 'çƒ­é—¨' },
                        { value: 'latest', label: 'æœ€æ–°' },
                        { value: 'anime', label: 'åŠ¨æ¼«' },
                        { value: 'game', label: 'æ¸¸æˆ' },
                        { value: 'original', label: 'åŸåˆ›' }
                    ]
                }
            },

            methods: {
                // å¯¼èˆªç»„ä»¶æ–¹æ³•
                toggleUserMenu() {
                    this.userMenuOpen = !this.userMenuOpen;
                },  
                showHelp() {
                    this.userMenuOpen = false;
                    alert('å¸®åŠ©ä¸­å¿ƒåŠŸèƒ½å¼€å‘ä¸­...');
                },
                resetUserData() {
                    this.userMenuOpen = false;
                    if (window.UserStateManager) {
                        window.UserStateManager.resetAllData();
                    }
                },

                async loadCases() {
                    this.loading = true;
                    try {
                        let url = '/api/v1/cases';
                        const params = new URLSearchParams({
                            page: this.page,
                            per_page: 12
                        });

                        if (this.currentFilter !== 'all') {
                            if (this.currentFilter === 'featured') {
                                url = '/api/v1/cases/featured';
                            } else if (this.currentFilter === 'popular') {
                                url = '/api/v1/cases/popular';
                            } else if (this.currentFilter === 'latest') {
                                url = '/api/v1/cases/latest';
                            } else {
                                params.append('category', this.currentFilter);
                            }
                        }

                        if (this.searchQuery) {
                            params.append('search', this.searchQuery);
                        }

                        const headers = {};
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }

                        const response = await fetch(`${url}?${params}`, {
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            if (this.page === 1) {
                                this.cases = data.cases;
                            } else {
                                this.cases.push(...data.cases);
                            }

                            this.hasMore = data.cases.length === 12;
                        }
                    } catch (error) {
                        console.error('åŠ è½½æ¡ˆä¾‹å¤±è´¥:', error);
                    } finally {
                        this.loading = false;
                    }
                },

                setFilter(filter) {
                    this.currentFilter = filter;
                    this.page = 1;
                    this.loadCases();
                },

                searchCases() {
                    this.page = 1;
                    this.loadCases();
                },

                clearSearch() {
                    this.searchQuery = '';
                    this.currentFilter = 'all';
                    this.page = 1;
                    this.loadCases();
                },

                async loadMore() {
                    this.page++;
                    await this.loadCases();
                },

                viewCase(caseId) {
                    window.location.href = `/view/${caseId}`;
                },

                async likeCase(caseId) {
                    try {
                        const headers = {
                            'Content-Type': 'application/json'
                        };
                        
                        // æ·»åŠ è®¾å¤‡IDå¤´
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }
                        
                        const response = await fetch(`/api/v1/cases/${caseId}/like`, {
                            method: 'POST',
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            const caseData = this.cases.find(c => c.id === caseId);
                            if (caseData) {
                                caseData.like_count = data.like_count;
                            }
                        } else {
                            alert(data.message || 'ç‚¹èµå¤±è´¥');
                        }
                    } catch (error) {
                        console.error('ç‚¹èµå¤±è´¥:', error);
                        alert('ç‚¹èµå¤±è´¥');
                    }
                },

                async makeSame(caseId) {
                    try {
                        const headers = {
                            'Content-Type': 'application/json'
                        };
                        
                        // æ·»åŠ è®¾å¤‡IDå¤´
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }
                        
                        const response = await fetch(`/api/v1/cases/${caseId}/make`, {
                            method: 'POST',
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            const caseData = this.cases.find(c => c.id === caseId);
                            if (caseData) {
                                caseData.make_count = data.make_count;
                            }
                            window.location.href = data.redirect_url;
                        }
                    } catch (error) {
                        console.error('åˆ¶ä½œåŒæ¬¾å¤±è´¥:', error);
                        alert('åˆ¶ä½œåŒæ¬¾å¤±è´¥');
                    }
                },

                async shareCase(caseId) {
                    try {
                        const headers = {
                            'Content-Type': 'application/json'
                        };
                        
                        // æ·»åŠ è®¾å¤‡IDå¤´
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }
                        
                        const response = await fetch(`/api/v1/cases/${caseId}/share`, {
                            method: 'POST',
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            // å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿
                            await navigator.clipboard.writeText(`${window.location.origin}${data.share_url}`);
                            alert('åˆ†äº«é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                        }
                    } catch (error) {
                        console.error('åˆ†äº«å¤±è´¥:', error);
                        alert('åˆ†äº«å¤±è´¥');
                    }
                },

                getImageUrl(imagePath) {
                    if (!imagePath) return '/static/images/placeholder.png';

                    // å¦‚æœæ˜¯å®Œæ•´URLï¼Œç›´æ¥è¿”å›
                    if (imagePath.startsWith('http')) {
                        return imagePath;
                    }

                    // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¤„ç†è·¯å¾„åˆ†éš”ç¬¦
                    let normalizedPath = imagePath.replace(/\\/g, '/');

                    // å¦‚æœè·¯å¾„ä»¥static/uploadså¼€å¤´ï¼Œæå–æ–‡ä»¶å
                    if (normalizedPath.includes('static/uploads/')) {
                        const filename = normalizedPath.split('/').pop();
                        return `/api/v1/image/${filename}`;
                    }

                    // å¦‚æœè·¯å¾„åŒ…å«uploadsï¼Œæå–æ–‡ä»¶å
                    if (normalizedPath.includes('uploads/')) {
                        const filename = normalizedPath.split('/').pop();
                        return `/api/v1/image/${filename}`;
                    }

                    // å¦‚æœåªæ˜¯æ–‡ä»¶åï¼Œç›´æ¥ä½¿ç”¨
                    if (!normalizedPath.includes('/')) {
                        return `/api/v1/image/${normalizedPath}`;
                    }

                    // å…¶ä»–æƒ…å†µï¼Œå°è¯•æå–æ–‡ä»¶å
                    const filename = normalizedPath.split('/').pop();
                    return `/api/v1/image/${filename}`;
                }
            },

            mounted() {
                this.loadCases();
            }
        }).mount('#app');
    </script>
</body>

</html>
