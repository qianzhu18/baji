<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ å§å”§ç”Ÿæˆå™¨ - ä¹”å¸ƒæ–¯å¼æè‡´ä½“éªŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="/static/js/device-manager.js"></script>
    <script src="/static/js/navigation.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .magic-button {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .magic-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 20px 40px rgba(78, 205, 196, 0.4);
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        .case-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .case-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);
        }

        .case-image {
            transition: transform 0.5s ease;
        }

        .case-card:hover .case-image {
            transform: scale(1.1);
        }

        .filter-btn {
            transition: all 0.2s ease;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            transform: scale(1.05);
        }

        .case-image-container {
            aspect-ratio: 1;
        }

        /* å¯¼èˆªç»„ä»¶æ ·å¼ */
        .user-menu-dropdown {
            transition: all 0.2s ease-out;
            transform-origin: top right;
        }

        .menu-open {
            opacity: 1;
            transform: translateY(0) scale(1);
            visibility: visible;
        }

        .menu-closed {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            visibility: hidden;
        }

        .user-menu-btn {
            transition: all 0.2s ease-out;
        }

        .user-menu-btn:hover {
            transform: translateY(-1px);
        }

        .user-menu-dropdown a,
        .user-menu-dropdown button {
            transition: all 0.15s ease-out;
        }

        .user-menu-dropdown a:hover,
        .user-menu-dropdown button:hover {
            transform: translateX(2px);
            background-color: rgba(59, 130, 246, 0.05);
        }
        
        /* é¦–é¡µç²¾é€‰æ¡ˆä¾‹åœ†å½¢é¢„è§ˆæ ·å¼ */
        .baji-preview-homepage {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            padding: 1rem;
        }
        
        .baji-frame-homepage {
            position: relative;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 0 20px rgba(59, 130, 246, 0.1),
                0 0 40px rgba(59, 130, 246, 0.05);
            overflow: hidden;
        }
        
        .baji-frame-homepage::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: radial-gradient(
                circle at center,
                transparent 0%,
                transparent 70%,
                rgba(0, 0, 0, 0.1) 85%,
                rgba(0, 0, 0, 0.2) 100%
            );
            pointer-events: none;
            z-index: 1;
        }
        
        .case-image {
            width: 160px !important;
            height: 160px !important;
            border-radius: 50%;
            object-fit: cover;
            transition: all 0.3s ease;
            position: relative;
            z-index: 0;
            cursor: pointer;
        }
        
        .case-card:hover .case-image {
            transform: scale(1.05);
        }
        
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .baji-frame-homepage {
                width: 280px;
                height: 280px;
            }
            
            .case-image {
                width: 250px !important;
                height: 250px !important;
            }
        }
    </style>
</head>

<body>
    <div id="app">


        <!-- Hero Section -->
        <section class="hero-section min-h-screen flex items-center justify-center">
            <div class="text-center text-white px-8">
                <div class="floating mb-8">
                    <h1 class="text-6xl font-bold mb-4">ğŸ</h1>
                    <h2 class="text-4xl font-bold mb-2">å§å”§ç”Ÿæˆå™¨</h2>
                    <p class="text-xl opacity-90">ä¹”å¸ƒæ–¯å¼æè‡´ä½“éªŒ</p>
                </div>

                <div class="mb-8">
                    <p class="text-lg opacity-80 mb-4">ç®€å•åˆ°æè‡´ï¼Œä¼˜é›…åˆ°å®Œç¾</p>
                    <p class="text-sm opacity-70">æ‹–æ‹½ä¸Šä¼  â†’ è°ƒæ•´å‚æ•° â†’ å®æ—¶é¢„è§ˆ â†’ ç¡®è®¤åˆ¶ä½œ</p>
                </div>

                <a href="/design"
                    class="magic-button inline-block px-8 py-4 rounded-full text-white font-semibold text-lg shadow-lg">
                    âœ¨ å¼€å§‹åˆ¶ä½œå§å”§
                </a>

                <div class="mt-12 text-sm opacity-60">
                    <p>"ç®€å•æ˜¯ç»ˆæçš„å¤æ‚" - å²è’‚å¤«Â·ä¹”å¸ƒæ–¯</p>
                </div>
            </div>
        </section>
        <!-- ç»Ÿä¸€å¯¼èˆªæ  -->
        <nav class="navbar bg-white shadow-sm border-b border-gray-200">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between h-16">
                    <!-- Logoå’Œæ ‡é¢˜ -->
                    <div class="flex items-center space-x-4">
                        <a href="/"
                            class="flex items-center space-x-2 text-blue-600 hover:text-blue-700 transition-colors">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                            </svg>
                            <span class="text-xl font-bold">å§å”§ç”Ÿæˆå™¨</span>
                        </a>
                    </div>

                    <!-- å¯¼èˆªèœå• -->
                    <div class="hidden md:flex items-center space-x-6">
                        <a href="/" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            é¦–é¡µ
                        </a>
                        <a href="/gallery" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            ä½œå“ç”»å»Š
                        </a>
                        <a href="/design" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            å¼€å§‹è®¾è®¡
                        </a>
                        <a href="/history" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            åˆ¶ä½œå†å²
                        </a>
                        <a href="/orders" class="nav-link text-gray-600 hover:text-blue-600 transition-colors">
                            æˆ‘çš„è®¢å•
                        </a>
                    </div>

                    <!-- ç”¨æˆ·èœå• -->
                    <div class="flex items-center space-x-2">
                        <div class="relative">
                            <button @click="toggleUserMenu"
                                class="user-menu-btn flex items-center space-x-2 p-2 rounded-lg text-gray-600 hover:text-blue-600 hover:bg-gray-100 transition-colors">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">
                                        </path>
                                    </svg>
                                </div>
                                <span class="hidden md:block text-sm font-medium">æˆ‘çš„è´¦æˆ·</span>
                                <svg class="w-4 h-4 transition-transform" :class="{ 'rotate-180': userMenuOpen }"
                                    fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>

                            <!-- ç”¨æˆ·èœå•ä¸‹æ‹‰ -->
                            <div v-show="userMenuOpen"
                                class="user-menu-dropdown absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50"
                                :class="{ 'menu-open': userMenuOpen, 'menu-closed': !userMenuOpen }">
                                <!-- ç”¨æˆ·ä¿¡æ¯ -->
                                <div class="px-4 py-3 border-b border-gray-100">
                                    <div class="flex items-center space-x-3">
                                        <div
                                            class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">
                                                </path>
                                            </svg>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">è®¿å®¢ç”¨æˆ·</p>
                                            <p class="text-xs text-gray-500">åŸºäºè®¢å•å·çš„èº«ä»½ç®¡ç†</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- å¿«é€Ÿæ“ä½œ -->
                                <div class="px-2 py-2">
                                    <a href="/"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path>
                                        </svg>
                                        é¦–é¡µ
                                    </a>
                                    <a href="/gallery"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                        ä½œå“ç”»å»Š
                                    </a>
                                    <a href="/design"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        å¼€å§‹è®¾è®¡
                                    </a>
                                    <a href="/orders"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2">
                                            </path>
                                        </svg>
                                        æˆ‘çš„è®¢å•
                                    </a>
                                    <a href="/history"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        è®¾è®¡å†å²
                                    </a>
                                    <a href="/delivery"
                                        class="flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4">
                                            </path>
                                        </svg>
                                        é…é€ç®¡ç†
                                    </a>
                                </div> 

                                <!-- åˆ†éš”çº¿ -->
                                <div class="border-t border-gray-100 my-2"></div>

                                <!-- å¸®åŠ©å’Œå…³äº -->
                                <div class="px-2 py-2">
                                    <button @click="showHelp"
                                        class="flex items-center w-full px-2 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                                            </path>
                                        </svg>
                                        å¸®åŠ©ä¸­å¿ƒ
                                    </button>
                                    <!-- <button @click="resetUserData"
                                        class="flex items-center w-full px-2 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md">
                                        <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                                            </path>
                                        </svg>
                                        é‡ç½®æ•°æ®
                                    </button> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <!-- ç²¾é€‰æ¡ˆä¾‹å±•ç¤ºåŒºåŸŸ -->
        <section class="featured-cases-section bg-gradient-to-br from-gray-50 to-gray-100 py-16">
            <div class="container mx-auto px-4">
                <!-- æ ‡é¢˜åŒºåŸŸ -->
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">
                        âœ¨ ç²¾é€‰æ¡ˆä¾‹
                    </h2>
                    <p class="text-lg text-gray-600 mb-8">
                        çœ‹çœ‹å…¶ä»–ç”¨æˆ·åˆ›ä½œçš„ç²¾å½©å§å”§ï¼Œè·å–çµæ„Ÿ
                    </p>
                    <div class="flex justify-center space-x-4">
                        <button v-for="filter in caseFilters" :key="filter.value"
                            :class="['case-filter-btn px-6 py-3 rounded-full font-medium transition-all duration-200', { active: currentCaseFilter === filter.value }]"
                            @click="setCaseFilter(filter.value)"
                            class="bg-white text-gray-600 hover:bg-blue-50 hover:text-blue-600 border border-gray-200 hover:border-blue-300">
                            <span v-text="filter.label"></span>
                        </button>
                    </div>
                </div>

                <!-- æ¡ˆä¾‹ç½‘æ ¼ -->
                <div v-if="featuredCases.length > 0"
                    class="cases-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <div v-for="caseData  in featuredCases" :key="caseData.id"
                        class="case-card group bg-white rounded-xl shadow-sm hover:shadow-xl overflow-hidden">

                        <div class="case-image-container relative overflow-hidden rounded-t-xl">
                            <div class="baji-preview-homepage">
                                <div class="baji-frame-homepage">
                                    <img :src="getImageUrl(caseData.preview_image_path)" :alt="caseData.title"
                                        class="case-image" @click="viewCase(caseData.id)">
                                </div>
                            </div>

                            <div class="case-badges absolute top-3 left-3">
                                <span v-if="caseData    .is_featured"
                                    class="badge badge-featured px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-600">
                                    â­ æ¨è
                                </span>
                            </div>

                            <div
                                class="case-overlay absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300">
                                <div class="case-actions flex gap-3">
                                    <button
                                        class="action-btn primary flex items-center space-x-2 px-4 py-2 rounded-full bg-white text-gray-800 hover:bg-blue-50 hover:text-blue-600 transform translate-y-4 group-hover:translate-y-0 transition-all duration-300"
                                        @click="makeSame(caseData.id)">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        <span>åˆ¶ä½œåŒæ¬¾</span>
                                    </button>
                                    <button
                                        class="action-btn secondary flex items-center space-x-2 px-4 py-2 rounded-full bg-white text-gray-800 hover:bg-red-50 hover:text-red-600 transform translate-y-4 group-hover:translate-y-0 transition-all duration-300"
                                        @click="likeCase(caseData.id)">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                                            </path>
                                        </svg>
                                        <span v-text="caseData.like_count"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="case-info p-4">
                            <h3 class="case-title text-lg font-semibold text-gray-800 mb-2" v-text="caseData.title">
                            </h3>
                            <p class="case-meta flex justify-between items-center text-sm text-gray-500">
                                <span class="case-category px-2 py-1 rounded-full bg-blue-100 text-blue-600"
                                    v-text="caseData   .category"></span>
                                <span class="case-stats text-gray-400"
                                    v-text="makeCountText(   caseData.make_count)"></span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- åŠ è½½çŠ¶æ€ -->
                <div v-else-if="loadingCases" class="text-center py-12">
                    <div
                        class="loading-spinner w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full mx-auto mb-4 animate-spin">
                    </div>
                    <p class="text-gray-600">åŠ è½½ä¸­...</p>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div v-else class="text-center py-12">
                    <div class="empty-icon mb-4">
                        <svg class="w-16 h-16 text-gray-400 mx-auto" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                            </path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">æš‚æ— æ¡ˆä¾‹</h3>
                    <p class="text-gray-600 mb-6">è¿˜æ²¡æœ‰ç²¾é€‰æ¡ˆä¾‹ï¼Œå¿«æ¥åˆ›ä½œç¬¬ä¸€ä¸ªå§ï¼</p>
                </div>

                <!-- æŸ¥çœ‹æ›´å¤š -->
                <div class="text-center mt-12">
                    <a href="/gallery"
                        class="btn btn-primary px-8 py-3 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors">
                        æŸ¥çœ‹æ›´å¤šæ¡ˆä¾‹
                    </a>
                </div>
            </div>
        </section>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    // å¯¼èˆªç»„ä»¶æ•°æ®
                    userMenuOpen: false,
                    // é¡µé¢æ•°æ®
                    featuredCases: [],
                    loadingCases: false,
                    currentCaseFilter: 'featured',
                    caseFilters: [
                        { value: 'featured', label: 'å®˜æ–¹æ¨è' },
                        { value: 'recommended', label: 'ä¸ºä½ æ¨è' },
                        { value: 'trending', label: 'çƒ­é—¨è¶‹åŠ¿' },
                        { value: 'popular', label: 'çƒ­é—¨ä½œå“' },
                        { value: 'latest', label: 'æœ€æ–°ä½œå“' }
                    ]
                }
            },

            computed: {
                makeCountText() {
                    return (count) => `${count} äººåˆ¶ä½œ`;
                }
            },

            methods: {
                // å¯¼èˆªç»„ä»¶æ–¹æ³•
                toggleUserMenu() {
                    this.userMenuOpen = !this.userMenuOpen;
                },  
                showHelp() {
                    this.userMenuOpen = false;
                    alert('å¸®åŠ©ä¸­å¿ƒåŠŸèƒ½å¼€å‘ä¸­...');
                },
                // resetUserData() {
                //     this.userMenuOpen = false;
                //     if (window.UserStateManager) {
                //         window.UserStateManager.resetAllData();
                //     }
                // },

                async loadFeaturedCases() {
                    this.loadingCases = true;
                    try {
                        let url = '/api/v1/cases/featured';
                        if (this.currentCaseFilter === 'popular') {
                            url = '/api/v1/cases/popular';
                        } else if (this.currentCaseFilter === 'latest') {
                            url = '/api/v1/cases/latest';
                        } else if (this.currentCaseFilter === 'recommended') {
                            url = '/api/v1/cases/recommended';
                        } else if (this.currentCaseFilter === 'trending') {
                            url = '/api/v1/cases/trending';
                        }

                        const headers = {};
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }

                        const response = await fetch(`${url}?limit=8`, {
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            this.featuredCases = data.cases;
                        }
                    } catch (error) {
                        console.error('åŠ è½½ç²¾é€‰æ¡ˆä¾‹å¤±è´¥:', error);
                    } finally {
                        this.loadingCases = false;
                    }
                },

                setCaseFilter(filter) {
                    this.currentCaseFilter = filter;
                    this.loadFeaturedCases();
                },

                viewCase(caseId) {
                    window.location.href = `/view/${caseId}`;
                },

                async likeCase(caseId) {
                    try {
                        const headers = {
                            'Content-Type': 'application/json'
                        };
                        
                        // æ·»åŠ è®¾å¤‡IDå¤´
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }
                        
                        const response = await fetch(`/api/v1/cases/${caseId}/like`, {
                            method: 'POST',
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            const caseData = this.featuredCases.find(c => c.id === caseId);
                            if (caseData) {
                                caseData.like_count = data.like_count;
                            }
                        } else {
                            alert(data.message || 'ç‚¹èµå¤±è´¥');
                        }
                    } catch (error) {
                        console.error('ç‚¹èµå¤±è´¥:', error);
                        alert('ç‚¹èµå¤±è´¥');
                    }
                },

                async makeSame(caseId) {
                    try {
                        const headers = {
                            'Content-Type': 'application/json'
                        };
                        
                        // æ·»åŠ è®¾å¤‡IDå¤´
                        if (window.DeviceManager && window.DeviceManager.getDeviceId()) {
                            headers['X-Device-ID'] = window.DeviceManager.getDeviceId();
                        }
                        
                        const response = await fetch(`/api/v1/cases/${caseId}/make`, {
                            method: 'POST',
                            headers: headers
                        });
                        const data = await response.json();

                        if (data.success) {
                            const caseData = this.featuredCases.find(c => c.id === caseId);
                            if (caseData) {
                                caseData.make_count = data.make_count;
                            }
                            window.location.href = data.redirect_url;
                        }
                    } catch (error) {
                        console.error('åˆ¶ä½œåŒæ¬¾å¤±è´¥:', error);
                        alert('åˆ¶ä½œåŒæ¬¾å¤±è´¥');
                    }
                },

                getImageUrl(imagePath) {
                    if (!imagePath) return '/static/images/placeholder.png';

                    // å¦‚æœæ˜¯å®Œæ•´URLï¼Œç›´æ¥è¿”å›
                    if (imagePath.startsWith('http')) {
                        return imagePath;
                    }

                    // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¤„ç†è·¯å¾„åˆ†éš”ç¬¦
                    let normalizedPath = imagePath.replace(/\\/g, '/');

                    // å¦‚æœè·¯å¾„ä»¥static/uploadså¼€å¤´ï¼Œæå–æ–‡ä»¶å
                    if (normalizedPath.includes('static/uploads/')) {
                        const filename = normalizedPath.split('/').pop();
                        return `/api/v1/image/${filename}`;
                    }

                    // å¦‚æœè·¯å¾„åŒ…å«uploadsï¼Œæå–æ–‡ä»¶å
                    if (normalizedPath.includes('uploads/')) {
                        const filename = normalizedPath.split('/').pop();
                        return `/api/v1/image/${filename}`;
                    }

                    // å¦‚æœåªæ˜¯æ–‡ä»¶åï¼Œç›´æ¥ä½¿ç”¨
                    if (!normalizedPath.includes('/')) {
                        return `/api/v1/image/${normalizedPath}`;
                    }

                    // å…¶ä»–æƒ…å†µï¼Œå°è¯•æå–æ–‡ä»¶å
                    const filename = normalizedPath.split('/').pop();
                    return `/api/v1/image/${filename}`;
                }
            },

            mounted() {
                this.loadFeaturedCases();
            }
        }).mount('#app');
    </script>
</body>

</html>