# 基于设备ID的用户绑定测试数据集

## 测试设备ID数据

### 设备ID格式
- 前缀：`DEV`
- 时间戳：13位毫秒时间戳
- 随机字符串：9位随机字符
- 示例：`DEV1703123456789ABC123DEF`

### 测试设备列表
```json
{
  "test_devices": [
    {
      "device_id": "DEV1703123456789ABC123DEF",
      "ip_address": "192.168.1.100",
      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
      "first_seen": "2024-01-01T10:00:00Z",
      "last_seen": "2024-01-01T15:30:00Z",
      "is_active": true
    },
    {
      "device_id": "DEV1703123456790XYZ789GHI",
      "ip_address": "192.168.1.101",
      "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",
      "first_seen": "2024-01-01T11:00:00Z",
      "last_seen": "2024-01-01T16:00:00Z",
      "is_active": true
    },
    {
      "device_id": "DEV1703123456791MNO456JKL",
      "ip_address": "192.168.1.102",
      "user_agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15",
      "first_seen": "2024-01-01T12:00:00Z",
      "last_seen": "2024-01-01T14:00:00Z",
      "is_active": false
    }
  ]
}
```

## 测试订单数据

### 设备1的订单数据
```json
{
  "device_1_orders": [
    {
      "order_no": "BJI20240101100001ABC123",
      "device_id": "DEV1703123456789ABC123DEF",
      "ip_address": "192.168.1.100",
      "original_image_path": "/uploads/2025/01/test_image_1.jpg",
      "processed_image_path": "/static/exports/BJI20240101100001ABC123.png",
      "preview_image_path": "/static/exports/preview_BJI20240101100001ABC123.png",
      "quantity": 1,
      "unit_price": 15.00,
      "total_price": 15.00,
      "status": "completed",
      "payment_method": "coupon",
      "payment_status": "paid",
      "payment_time": "2024-01-01T10:30:00Z",
      "coupon_id": 1,
      "notes": "{\"edit_params\": {\"scale\": 1.0, \"rotation\": 0, \"offset_x\": 0, \"offset_y\": 0}}",
      "created_at": "2024-01-01T10:00:00Z",
      "updated_at": "2024-01-01T10:30:00Z"
    },
    {
      "order_no": "BJI20240101100002ABC124",
      "device_id": "DEV1703123456789ABC123DEF",
      "ip_address": "192.168.1.100",
      "original_image_path": "/uploads/2025/01/test_image_2.jpg",
      "processed_image_path": "/static/exports/BJI20240101100002ABC124.png",
      "preview_image_path": "/static/exports/preview_BJI20240101100002ABC124.png",
      "quantity": 2,
      "unit_price": 15.00,
      "total_price": 30.00,
      "status": "pending",
      "payment_method": "coupon",
      "payment_status": "unpaid",
      "payment_time": null,
      "coupon_id": null,
      "notes": "{\"edit_params\": {\"scale\": 1.2, \"rotation\": 15, \"offset_x\": 10, \"offset_y\": -5}}",
      "created_at": "2024-01-01T11:00:00Z",
      "updated_at": "2024-01-01T11:00:00Z"
    }
  ]
}
```

### 设备2的订单数据
```json
{
  "device_2_orders": [
    {
      "order_no": "BJI20240101100003XYZ789",
      "device_id": "DEV1703123456790XYZ789GHI",
      "ip_address": "192.168.1.101",
      "original_image_path": "/uploads/2025/01/test_image_3.jpg",
      "processed_image_path": "/static/exports/BJI20240101100003XYZ789.png",
      "preview_image_path": "/static/exports/preview_BJI20240101100003XYZ789.png",
      "quantity": 1,
      "unit_price": 15.00,
      "total_price": 15.00,
      "status": "completed",
      "payment_method": "coupon",
      "payment_status": "paid",
      "payment_time": "2024-01-01T11:30:00Z",
      "coupon_id": 2,
      "notes": "{\"edit_params\": {\"scale\": 0.8, \"rotation\": -10, \"offset_x\": -5, \"offset_y\": 10}}",
      "created_at": "2024-01-01T11:00:00Z",
      "updated_at": "2024-01-01T11:30:00Z"
    }
  ]
}
```

### 设备3的订单数据
```json
{
  "device_3_orders": [
    {
      "order_no": "BJI20240101100004MNO456",
      "device_id": "DEV1703123456791MNO456JKL",
      "ip_address": "192.168.1.102",
      "original_image_path": "/uploads/2025/01/test_image_4.jpg",
      "processed_image_path": null,
      "preview_image_path": "/static/exports/preview_BJI20240101100004MNO456.png",
      "quantity": 1,
      "unit_price": 15.00,
      "total_price": 15.00,
      "status": "processing",
      "payment_method": "coupon",
      "payment_status": "paid",
      "payment_time": "2024-01-01T12:30:00Z",
      "coupon_id": 3,
      "notes": "{\"edit_params\": {\"scale\": 1.5, \"rotation\": 30, \"offset_x\": 20, \"offset_y\": -10}}",
      "created_at": "2024-01-01T12:00:00Z",
      "updated_at": "2024-01-01T12:30:00Z"
    }
  ]
}
```

## 测试案例数据

### 设备1的案例数据
```json
{
  "device_1_cases": [
    {
      "case_no": "CS20240101100001ABC123",
      "order_id": 1,
      "device_id": "DEV1703123456789ABC123DEF",
      "title": "测试案例1",
      "description": "设备1的第一个测试案例",
      "original_image_path": "/uploads/2025/01/test_image_1.jpg",
      "preview_image_path": "/static/exports/preview_BJI20240101100001ABC123.png",
      "final_image_path": "/static/exports/BJI20240101100001ABC123.png",
      "case_type": "user",
      "status": "active",
      "is_featured": false,
      "is_public": true,
      "tags": "[\"测试\", \"设备1\"]",
      "category": "用户创作",
      "like_count": 5,
      "make_count": 2,
      "view_count": 15,
      "ip_address": "192.168.1.100",
      "created_at": "2024-01-01T10:30:00Z",
      "updated_at": "2024-01-01T10:30:00Z"
    }
  ]
}
```

## 测试券码数据

### 设备相关的券码数据
```json
{
  "device_coupons": [
    {
      "code": "TEST001",
      "device_id": "DEV1703123456789ABC123DEF",
      "amount": 15.00,
      "discount_type": "fixed",
      "discount_value": 5.00,
      "min_order_amount": 10.00,
      "max_discount_amount": null,
      "usage_limit": 1,
      "used_count": 1,
      "is_active": true,
      "valid_from": "2024-01-01T00:00:00Z",
      "valid_until": "2024-12-31T23:59:59Z",
      "used_at": "2024-01-01T10:30:00Z",
      "order_id": 1,
      "created_at": "2024-01-01T00:00:00Z"
    },
    {
      "code": "TEST002",
      "device_id": "DEV1703123456790XYZ789GHI",
      "amount": 15.00,
      "discount_type": "percentage",
      "discount_value": 20.00,
      "min_order_amount": 15.00,
      "max_discount_amount": 10.00,
      "usage_limit": 1,
      "used_count": 1,
      "is_active": true,
      "valid_from": "2024-01-01T00:00:00Z",
      "valid_until": "2024-12-31T23:59:59Z",
      "used_at": "2024-01-01T11:30:00Z",
      "order_id": 3,
      "created_at": "2024-01-01T00:00:00Z"
    }
  ]
}
```

## 测试配送数据

### 设备相关的配送数据
```json
{
  "device_deliveries": [
    {
      "delivery_no": "DLV20240101100001ABC123",
      "order_ids": "1,2",
      "device_id": "DEV1703123456789ABC123DEF",
      "recipient_name": "张三",
      "phone": "13800138000",
      "email": "zhangsan@example.com",
      "address": "北京市朝阳区测试街道123号",
      "city": "北京",
      "province": "北京",
      "postal_code": "100000",
      "delivery_method": "standard",
      "delivery_fee": 0.00,
      "status": "pending",
      "tracking_number": null,
      "shipped_at": null,
      "delivered_at": null,
      "notes": "设备1的配送订单",
      "created_at": "2024-01-01T12:00:00Z",
      "updated_at": "2024-01-01T12:00:00Z"
    }
  ]
}
```

## 测试案例互动数据

### 设备相关的案例互动数据
```json
{
  "device_case_interactions": [
    {
      "case_id": 1,
      "device_id": "DEV1703123456789ABC123DEF",
      "interaction_type": "like",
      "ip_address": "192.168.1.100",
      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
      "created_at": "2024-01-01T10:35:00Z"
    },
    {
      "case_id": 1,
      "device_id": "DEV1703123456790XYZ789GHI",
      "interaction_type": "view",
      "ip_address": "192.168.1.101",
      "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",
      "created_at": "2024-01-01T11:00:00Z"
    },
    {
      "case_id": 1,
      "device_id": "DEV1703123456791MNO456JKL",
      "interaction_type": "make",
      "ip_address": "192.168.1.102",
      "user_agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15",
      "created_at": "2024-01-01T12:00:00Z"
    }
  ]
}
```

## 测试场景数据

### 场景1：正常设备隔离测试
- 设备1只能看到自己的订单
- 设备2只能看到自己的订单
- 设备3只能看到自己的订单

### 场景2：设备ID验证测试
- 无效设备ID格式
- 缺失设备ID头
- 设备ID不存在的请求

### 场景3：后台管理测试
- 管理员可以查看所有设备
- 管理员可以按设备ID筛选订单
- 管理员可以查看设备会话信息

### 场景4：数据迁移测试
- 现有订单分配设备ID
- 现有案例分配设备ID
- 现有券码分配设备ID

## 预期测试结果

### 成功场景
1. 设备1查询订单：返回2个订单
2. 设备2查询订单：返回1个订单
3. 设备3查询订单：返回1个订单
4. 管理员查询所有订单：返回4个订单
5. 管理员按设备ID筛选：正确筛选

### 失败场景
1. 无设备ID请求：返回400错误
2. 无效设备ID格式：返回400错误
3. 设备ID不存在：返回404错误
4. 跨设备访问：返回403错误
